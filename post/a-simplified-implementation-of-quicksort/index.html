<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>A Simplified Implementation of Quicksort - Saikat Kumar Dey</title><meta name=description content="A simple implementation of quicksort that trades space complexity for readability"><meta name=author content="Saikat Kumar Dey"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"Saikat Kumar Dey","url":"https:\/\/saikatkumardey.com"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/saikatkumardey.com"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/saikatkumardey.com","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/saikatkumardey.com\/post\/a-simplified-implementation-of-quicksort\/","name":"A simplified implementation of quicksort"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"Saikat Kumar Dey"},"headline":"A Simplified Implementation of Quicksort","description":"A simple implementation of quicksort that trades space complexity for readability","inLanguage":"en","wordCount":835,"datePublished":"2021-09-05T09:59:45","dateModified":"2021-09-05T09:59:45","image":"https:\/\/saikatkumardey.com","keywords":[""],"mainEntityOfPage":"https:\/\/saikatkumardey.com\/post\/a-simplified-implementation-of-quicksort\/","publisher":{"@type":"Organization","name":"https:\/\/saikatkumardey.com","logo":{"@type":"ImageObject","url":"https:\/\/saikatkumardey.com","height":60,"width":60}}}</script><meta property="og:url" content="https://saikatkumardey.com/post/a-simplified-implementation-of-quicksort/"><meta property="og:type" content="website"><meta property="og:site_name" content="Saikat Kumar Dey"><link rel=apple-touch-icon sizes=180x180 href=https://saikatkumardey.com/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://saikatkumardey.com/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://saikatkumardey.com/favicon/favicon-16x16.png><meta name=generator content="Hugo 0.115.4"><link rel=alternate href=https://saikatkumardey.com/index.xml type=application/rss+xml title="Saikat Kumar Dey"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link rel=stylesheet href=https://saikatkumardey.com/css/main.css><link disabled id=dark-mode-theme rel=stylesheet href=https://saikatkumardey.com/css/dark.css><link rel=stylesheet href=https://saikatkumardey.com/css/highlight.min.css><link rel=stylesheet href=https://saikatkumardey.com/css/codeblock.css></head><body><div class="container fixed-top"><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-10 col-xl-10"><nav class="navbar navbar-expand-lg navbar-light fixed-top p-0"><div class=container><a class="navbar-brand fw-bold" href=https://saikatkumardey.com>Saikat Kumar Dey</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end" id=navbarNav><ul class="navbar-nav mb-2 mb-lg-0"><li class=nav-item><a class=nav-link title=Home href=/>Home</a></li><li class=nav-item><a class=nav-link title=Projects href=/projects/>Projects</a></li><li class=nav-item><a class=nav-link title=Now href=/now/>Now</a></li><li class="nav-item nav-link"><a id=dark-mode-toggle class="bi bi-sun"></a></li></ul></div></div></nav></div></div></div><header class=header-section><div class="intro-header no-img mt-10"><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-8 col-xl-8"><div class="col-sm-12 col-md-12 col-lg-12 col-xl-12"><div class=post-heading><h1 class="fw-semibold display-5 lh-1 mb-3">A Simplified Implementation of Quicksort</h1><span class=post-meta>&nbsp;September 5, 2021</span></div></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1"><div class="card-image card-image-blog p-0"></div></div><div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4"><article role=main class=blog-post><p>Quicksort is a beautiful algorithm. It&rsquo;s considered the fastest sorting algorithm in practice. Most implementations I&rsquo;ve seen online are complicated. This post will demonstrate a simple implementation that trades space complexity for readability.</p><h2 id=how-does-quicksort-work>How does quicksort work?</h2><p>3 steps.</p><ol><li><strong>Choose</strong> a pivot element.</li><li><strong>Partition</strong>: Put all elements smaller than the pivot in a smaller array, (say, smaller_subarray). Put all elements greater than the pivot in another array (say, greater_subarray).</li><li><strong>Recurse & Merge</strong>: Recursively sort the smaller and greater sub-arrays. Merge the sorted arrays with the pivot.</li></ol><h2 id=how-do-we-implement-it-in-python>How do we implement it in Python?</h2><p>Let&rsquo;s start with the high-level function <code>quicksort()</code></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>quicksort</span>(array: List[<span style=color:#999>int</span>]) <span style=font-weight:700>-&gt;</span> List[<span style=color:#999>int</span>]:
</span></span><span style=display:flex><span>    <span style=color:#b84>&#34;&#34;&#34;Recursive implementation of quicksort.
</span></span></span><span style=display:flex><span><span style=color:#b84>
</span></span></span><span style=display:flex><span><span style=color:#b84>    Args:
</span></span></span><span style=display:flex><span><span style=color:#b84>        array (List[int]): a list of integers
</span></span></span><span style=display:flex><span><span style=color:#b84>
</span></span></span><span style=display:flex><span><span style=color:#b84>    Returns:
</span></span></span><span style=display:flex><span><span style=color:#b84>        List[int]: sorted array
</span></span></span><span style=display:flex><span><span style=color:#b84>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#998;font-style:italic># Base case</span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>if</span> <span style=color:#999>len</span>(array) <span style=font-weight:700>&lt;=</span> <span style=color:#099>1</span>:
</span></span><span style=display:flex><span>        <span style=font-weight:700>return</span> array
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#998;font-style:italic># Step 1: choose a pivot</span>
</span></span><span style=display:flex><span>    pivot_idx <span style=font-weight:700>=</span> random<span style=font-weight:700>.</span>choice(<span style=color:#999>range</span>(<span style=color:#999>len</span>(array)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#998;font-style:italic># Step 2: partition</span>
</span></span><span style=display:flex><span>    smaller_subarray, greater_subarray <span style=font-weight:700>=</span> partition(array, pivot_idx)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#998;font-style:italic># Step 3: Recurse on smaller and greater subarrays.</span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>return</span> (
</span></span><span style=display:flex><span>        quicksort(smaller_subarray)
</span></span><span style=display:flex><span>        <span style=font-weight:700>+</span> [array[pivot_idx]]
</span></span><span style=display:flex><span>        <span style=font-weight:700>+</span> quicksort(greater_subarray)
</span></span><span style=display:flex><span>    )
</span></span></code></pre></div><p>Let&rsquo;s go line by line,</p><h3 id=base-case>Base case</h3><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span> <span style=font-weight:700>if</span> <span style=color:#999>len</span>(array) <span style=font-weight:700>&lt;=</span> <span style=color:#099>1</span>:
</span></span><span style=display:flex><span>     <span style=font-weight:700>return</span> array
</span></span></code></pre></div><p>Every recursive function must have one. If we have an empty or single-item array, there&rsquo;s nothing to sort. We simply return the array.</p><h3 id=step-1-choose-a-pivot>Step 1: Choose a pivot</h3><p><code>pivot_idx = random.choice(range(len(array)))</code></p><p>The choice of pivot is the difference between having an <code>O(N log N)</code> vs <code>O(N^2)</code> time complexity.</p><p>How so? Let&rsquo;s take an example.</p><p>The worst-case involves having an already sorted array.</p><p><code>array = [1,2,3,4,5]</code></p><p>The image below shows recursion trees using two different pivot selection strategies:</p><p><strong>Legend</strong></p><ul><li>Blue lines => the greater subarray.</li><li>Orange lines => the smaller subarray.</li><li>Red lines => the pivot.</li></ul><p><img src=https://cdn.hashnode.com/res/hashnode/image/upload/v1630829735302/4wvnJNbu8.png alt="Screenshot 2021-09-05 at 1.45.23 PM.png"></p><ol><li><p>Left shows the case where we always choose the first/last item as the pivot. This leads to higher recursion depth as the subproblem size reduces by 1 at each level. We have roughly <code>O(N)</code> levels / recursive calls. Since joining the sub-arrays with the pivot is <code>O(N)</code>, this leads to <code>O(N^2)</code> time complexity.</p></li><li><p>Right shows the ideal case where we choose the median as the pivot at every level. This leads to balanced sub-problems. The recursion depth is lower, roughly <code>O(log N)</code>. This leads to <code>O(N log N)</code> time complexity.</p></li></ol><p><a href=https://www.cs.cmu.edu/afs/cs/academic/class/15451-s07/www/lecture_notes/lect0123.pdf>Choosing a random pivot leads to an <em>expected</em> runtime of <code>O(N log N)</code> time complexity</a>. We use that in this implementation.</p><p>Wait! There&rsquo;s still one case where <code>quicksort()</code> could be <code>O(N^2)</code>, even after choosing a randomized/median pivot. This is the case when every item in the array is identical. We could add a check to avoid this case as well.</p><p>According to this <a href=https://algs4.cs.princeton.edu/23quicksort/>source</a> ,</p><blockquote><p>The probability that quicksort will use a quadratic number of compares when sorting a large array on your computer is much less than the probability that your computer will be struck by lightning!</p></blockquote><h3 id=step-2-partition>Step 2: Partition</h3><p>We write the high-level function assuming that we have a magic function <code>partition()</code> which returns two arrays.</p><ul><li><code>smaller_subarray</code>: all elements <code>&lt;=</code> the pivot</li><li><code>greater_subarray</code>: all elements <code>></code> the pivot</li></ul><p>The implementation of <code>partition()</code> is quite simple. We compare each item in the array with the pivot. If it&rsquo;s <code>&lt;=</code> pivot, we add it to the smaller sub-array, else we add it to the greater sub-array.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>partition</span>(array: List[<span style=color:#999>int</span>], pivot_idx: <span style=color:#999>int</span>) <span style=font-weight:700>-&gt;</span> Tuple[List[<span style=color:#999>int</span>], List[<span style=color:#999>int</span>]]:
</span></span><span style=display:flex><span>    <span style=color:#b84>&#34;&#34;&#34;Parition array into subarrays smaller and greater than the pivot.
</span></span></span><span style=display:flex><span><span style=color:#b84>
</span></span></span><span style=display:flex><span><span style=color:#b84>    Args:
</span></span></span><span style=display:flex><span><span style=color:#b84>        array (List[int]): input array
</span></span></span><span style=display:flex><span><span style=color:#b84>        pivot_idx (int): index of the pivot
</span></span></span><span style=display:flex><span><span style=color:#b84>
</span></span></span><span style=display:flex><span><span style=color:#b84>    Returns:
</span></span></span><span style=display:flex><span><span style=color:#b84>        Tuple[List[int], List[int]]: smaller subarray, greater subarray
</span></span></span><span style=display:flex><span><span style=color:#b84>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    smaller_subarray, greater_subarray <span style=font-weight:700>=</span> [], []
</span></span><span style=display:flex><span>    <span style=font-weight:700>for</span> idx, item <span style=font-weight:700>in</span> <span style=color:#999>enumerate</span>(array):
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># we don&#39;t want to add pivot to any of the sub-arrays</span>
</span></span><span style=display:flex><span>        <span style=font-weight:700>if</span> idx <span style=font-weight:700>==</span> pivot_idx:
</span></span><span style=display:flex><span>            <span style=font-weight:700>continue</span>
</span></span><span style=display:flex><span>        <span style=font-weight:700>if</span> item <span style=font-weight:700>&lt;=</span> array[pivot_idx]:
</span></span><span style=display:flex><span>            smaller_subarray<span style=font-weight:700>.</span>append(item)
</span></span><span style=display:flex><span>        <span style=font-weight:700>else</span>:
</span></span><span style=display:flex><span>            greater_subarray<span style=font-weight:700>.</span>append(item)
</span></span><span style=display:flex><span>    <span style=font-weight:700>return</span> smaller_subarray, greater_subarray
</span></span></code></pre></div><h3 id=step-3-merge>Step 3: Merge</h3><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>return</span> (
</span></span><span style=display:flex><span>        quicksort(smaller_subarray)
</span></span><span style=display:flex><span>        <span style=font-weight:700>+</span> [array[pivot_idx]]
</span></span><span style=display:flex><span>        <span style=font-weight:700>+</span> quicksort(greater_subarray)
</span></span><span style=display:flex><span>    )
</span></span></code></pre></div><p>This step is quite exquisite. We recurse on the smaller and greater sub-arrays and place the pivot in between them. The beauty of a recursive implementation is that we could re-use our function with a smaller size of the input and trust that it would work.</p><p>Let&rsquo;s unroll it a bit.</p><ul><li><code>quicksort(smaller_subarray)</code> => returns a sorted version of the <code>smaller_subarray</code></li><li><code>[array[pivot_idx]]</code> => out pivot in a list. It&rsquo;s needed for concatenating it with the other two lists.</li><li><code>quicksort(greater_subarray)</code> => returns a sorted version of the <code>greater_subarray</code></li></ul><p>Now, we join the 3 lists including the pivot, and return the final sorted list.</p><h2 id=complexity>Complexity</h2><h3 id=time>Time</h3><p><strong>Expected</strong> run-time of <code>O(N log N)</code> since it&rsquo;s a randomized implementation.</p><p>We do <code>O(N)</code> work at each <code>quicksort()</code> call. The major components are <code>partition()</code> and merge step - both are <code>O(N)</code>.</p><p>For randomized implementation, we have O(log N) levels/recursive calls.</p><p>So, expected time complexity ~ <code>Number of recursive calls</code> * <code>work done per recursive call</code> ~ <code>O(N) * O(log N)</code> ~ <code>O(N log N)</code></p><h3 id=space>Space</h3><p><code>O(N)</code> since we use extra space for storing the smaller and greater sub-arrays. The recursion stack also uses <code>O(log N)</code> space. Overall, this implementation uses <code>O(N)</code> space.</p><p>The in-place implementation without using auxiliary lists would lead to an <code>O(log N)</code> space complexity.</p><h2 id=the-code>The code</h2><p>The implementation including the <code>partition()</code> and tests are <a href=https://gist.github.com/saikatkumardey/5c0eb3ed8d187046ed7d46ff4dab8fe1>here</a>.</p></article></div></div><div class=row><div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1"><hr></div><div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-2"></div><div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4"><section id=social-share><div class="list-inline footer-links"><div class=share-box aria-hidden=true><div><p class="list-inline footer-links">Use the share button below if you liked it.</p></div><ul class=share><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fsaikatkumardey.com%2fpost%2fa-simplified-implementation-of-quicksort%2f" target=_blank title="Share on Facebook"><i class="bi bi-facebook facebook-color"></i></a></li><li><a href="//twitter.com/share?url=https%3a%2f%2fsaikatkumardey.com%2fpost%2fa-simplified-implementation-of-quicksort%2f&amp;text=A%20Simplified%20Implementation%20of%20Quicksort&amp;via=map%5bemail%3asample%40gmail.com%20facebook%3ausername%20github%3asaikatkumardey%20linkedin%3asaikatkumardey%20name%3aSaikat%20Kumar%20Dey%20twitter%3asaikatkrdey%20website%3ahttps%3a%2f%2fsaikatkumardey.com%2f%20youtube%3a%5d" target=_blank title="Share on Twitter"><i class="bi bi-twitter twitter-color"></i></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fsaikatkumardey.com%2fpost%2fa-simplified-implementation-of-quicksort%2f&amp;title=A%20Simplified%20Implementation%20of%20Quicksort" target=_blank title="Share on Reddit"><i class="bi bi-reddit reddit-color"></i></a></li><li><a href="whatsapp://send?text=https%3a%2f%2fsaikatkumardey.com%2fpost%2fa-simplified-implementation-of-quicksort%2f&amp;description=A%20Simplified%20Implementation%20of%20Quicksort" target=_blank rel=noopener title="Share on WhatsApp"><i class="bi bi-whatsapp whatsapp-color"></i></a></li></ul></div></div></section></div><div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4"><ul class="list-group list-group-horizontal" style=flex-direction:row><li class="list-group-item b-0"><a type=button class="btn btn-dark" role=button href=https://saikatkumardey.com/post/deep-nn-for-youtube-recommendations/ data-toggle=tooltip data-placement=top title="Deep Neural Networks for YouTube Recommendations">&larr;
Previous Post</a></li><li class="list-group-item ms-auto b-0"><a type=button class="btn btn-dark" role=button href=https://saikatkumardey.com/post/book-notes-anything-you-want-by-derek-sivers/ data-toggle=tooltip data-placement=top title="Anything You Want by Derek Sivers">Next Post
&rarr;</a></li></ul></div><div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4"></div></div></div><div><div class=container><div class=row></div></div></div></div></div><footer><div class=container><div class=row><div class=col-md-12><ul class="list-inline list-group list-group-horizontal text-center footer-links d-flex justify-content-center flex-row"><li><a href=mailto:sample@gmail.com title="Email me" target=_blank><span class=mx-2><i class="bi bi-envelope"></i></span></a></li><li><a href=https://www.facebook.com/username title=Facebook target=_blank><span class=mx-2><i class="bi bi-facebook"></i></span></a></li><li><a href=https://github.com/saikatkumardey title=GitHub target=_blank><span class=mx-2><i class="bi bi-github"></i></span></a></li><li><a href=https://twitter.com/saikatkrdey title=Twitter target=_blank><span class=mx-2><i class="bi bi-twitter"></i></span></a></li><li><a href=https://linkedin.com/in/saikatkumardey title=LinkedIn target=_blank><span class=mx-2><i class="bi bi-linkedin"></i></span></a></li><li><a href=https://www.youtube.com/ title=Youtube target=_blank><span class=mx-2><i class="bi bi-youtube"></i></span></a></li></ul></div></div><div class=row><div class=col-md-12><p class="credits copyright text-muted"><a href=https://saikatkumardey.com/>Saikat Kumar Dey</a>
&nbsp;&bull;&nbsp;&copy;
2023
&nbsp;&bull;&nbsp;
<a href=https://saikatkumardey.com>Saikat Kumar Dey</a></p><p class="credits theme-by text-muted">Powered by <a href=https://gohugo.io>Hugo</a> & <a href=https://github.com/binokochumolvarghese/lightbi-hugo>Lightbi.</a>&nbsp; Made with ❤ by <a href=https://binovarghese.com>Bino</a></p></div></div></div></footer><script src=https://code.jquery.com/jquery-3.7.0.slim.min.js integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js integrity=sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ crossorigin=anonymous></script>
<script src=https://saikatkumardey.com/js/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><script>$(document).ready(function(){$("pre.chroma").css("padding","0")})</script><script src=https://saikatkumardey.com/js/dark-mode.js></script></body></html>