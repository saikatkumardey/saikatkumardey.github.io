<!doctype html><html dir=ltr lang=en data-theme class="html theme--light"><head><title>A Simplified Implementation of Quicksort |
Saikat Kumar Dey</title><meta charset=utf-8><meta name=generator content="Hugo 0.111.3"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=author content="Saikat Kumar Dey"><meta name=description content="Machine Learning Engineer"><link rel=stylesheet href=/scss/main.min.1147aa5bacb4bce677a0e264073829caedb82fd18ea07a5f1d80521f539d1c45.css integrity="sha256-EUeqW6y0vOZ3oOJkBzgpyu24L9GOoHpfHYBSH1OdHEU=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc=" crossorigin=anonymous type=text/css><link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png><link rel=canonical href=https://saikatkumardey.com/post/a-simplified-implementation-of-quicksort/><script type=text/javascript src=/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js integrity="sha256-+RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc=" crossorigin=anonymous></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://saikatkumardey.com/images/site-feature-image.png"><meta name=twitter:title content="A Simplified Implementation of Quicksort"><meta name=twitter:description content="A simple implementation of quicksort that trades space complexity for readability"><meta property="og:title" content="A Simplified Implementation of Quicksort"><meta property="og:description" content="A simple implementation of quicksort that trades space complexity for readability"><meta property="og:type" content="article"><meta property="og:url" content="https://saikatkumardey.com/post/a-simplified-implementation-of-quicksort/"><meta property="og:image" content="https://saikatkumardey.com/images/site-feature-image.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-09-05T09:59:45+05:30"><meta property="article:modified_time" content="2021-09-05T09:59:45+05:30"><meta property="og:site_name" content="Saikat Kumar Dey"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"post","name":"A Simplified Implementation of Quicksort","headline":"A Simplified Implementation of Quicksort","alternativeHeadline":"","description":"
      
        A simple implementation of quicksort that trades space complexity for readability


      


    ","inLanguage":"en","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/saikatkumardey.com\/post\/a-simplified-implementation-of-quicksort\/"},"author":{"@type":"Person","name":"Saikat Kumar Dey"},"creator":{"@type":"Person","name":"Saikat Kumar Dey"},"accountablePerson":{"@type":"Person","name":"Saikat Kumar Dey"},"copyrightHolder":{"@type":"Person","name":"Saikat Kumar Dey"},"copyrightYear":"2021","dateCreated":"2021-09-05T09:59:45.00Z","datePublished":"2021-09-05T09:59:45.00Z","dateModified":"2021-09-05T09:59:45.00Z","publisher":{"@type":"Organization","name":"Saikat Kumar Dey","url":"https://saikatkumardey.com","logo":{"@type":"ImageObject","url":"https:\/\/saikatkumardey.com\/favicons\/favicon-32x32.png","width":"32","height":"32"}},"image":["https://saikatkumardey.com/images/site-feature-image.png"],"url":"https:\/\/saikatkumardey.com\/post\/a-simplified-implementation-of-quicksort\/","wordCount":"835","genre":[],"keywords":["coding"]}</script></head><body class=body><div class=wrapper><aside class=wrapper__sidebar><div class="sidebar
animated fadeInDown"><div class=sidebar__content><div class=sidebar__introduction><img class=sidebar__introduction-profileimage src=/images/dp.jpg alt="profile picture"><div class=sidebar__introduction-title><a href=/>Saikat Kumar Dey</a></div><div class=sidebar__introduction-description><p>Machine Learning Engineer</p></div></div><ul class=sidebar__list><li class=sidebar__list-item><a href=https://linkedin.com/in/saikatkumardey target=_blank rel="noopener me" aria-label=Linkedin title=Linkedin><i class="fab fa-linkedin fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://github.com/saikatkumardey/ target=_blank rel="noopener me" aria-label=GitHub title=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://www.instagram.com/saikatkumardey/ target=_blank rel="noopener me" aria-label=instagram title=instagram><i class="fab fa-instagram fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://twitter.com/saikatkrdey target=_blank rel="noopener me" aria-label=twitter title=twitter><i class="fab fa-twitter fa-2x" aria-hidden=true></i></a></li></ul></div><footer class="footer footer__sidebar"><ul class=footer__list><li class=footer__item>&copy;
Saikat Kumar Dey
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></div></aside><main class=wrapper__main><header class=header><div class="animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span></a><nav class=nav><ul class=nav__list id=navMenu><li class=nav__list-item><a href=/ title>Home</a></li><li class=nav__list-item><a href=/post/ title>Posts</a></li><li class=nav__list-item><a href=/projects/ title>Projects</a></li><li class=nav__list-item><a href=/now/ title>Now</a></li><li class=nav__list-item><a href=/contact/ title>Contact</a></li></ul><ul class="nav__list nav__list--end"><li class=nav__list-item><div class=themeswitch><a title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></li></ul></nav></div></header><div class="post
animated fadeInDown"><div class=post__content><h1>A Simplified Implementation of Quicksort</h1><ul class=post__meta><li class=post__meta-item><em class="fas fa-calendar-day post__meta-icon"></em>
<span class=post__meta-text>5/9/2021</span></li><li class=post__meta-item><em class="fas fa-stopwatch post__meta-icon"></em>
<span class=post__meta-text>4-minute read</span></li></ul><p>Quicksort is a beautiful algorithm. It&rsquo;s considered the fastest sorting algorithm in practice. Most implementations I&rsquo;ve seen online are complicated. This post will demonstrate a simple implementation that trades space complexity for readability.</p><h2 id=how-does-quicksort-work>How does quicksort work?</h2><p>3 steps.</p><ol><li><strong>Choose</strong> a pivot element.</li><li><strong>Partition</strong>: Put all elements smaller than the pivot in a smaller array, (say, smaller_subarray). Put all elements greater than the pivot in another array (say, greater_subarray).</li><li><strong>Recurse & Merge</strong>: Recursively sort the smaller and greater sub-arrays. Merge the sorted arrays with the pivot.</li></ol><h2 id=how-do-we-implement-it-in-python>How do we implement it in Python?</h2><p>Let&rsquo;s start with the high-level function <code>quicksort()</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>quicksort</span><span class=p>(</span><span class=n>array</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Recursive implementation of quicksort.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        array (List[int]): a list of integers
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        List[int]: sorted array
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Base case</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>array</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>array</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Step 1: choose a pivot</span>
</span></span><span class=line><span class=cl>    <span class=n>pivot_idx</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>array</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Step 2: partition</span>
</span></span><span class=line><span class=cl>    <span class=n>smaller_subarray</span><span class=p>,</span> <span class=n>greater_subarray</span> <span class=o>=</span> <span class=n>partition</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>pivot_idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Step 3: Recurse on smaller and greater subarrays.</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>quicksort</span><span class=p>(</span><span class=n>smaller_subarray</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>+</span> <span class=p>[</span><span class=n>array</span><span class=p>[</span><span class=n>pivot_idx</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=o>+</span> <span class=n>quicksort</span><span class=p>(</span><span class=n>greater_subarray</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div><p>Let&rsquo;s go line by line,</p><h3 id=base-case>Base case</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>array</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=k>return</span> <span class=n>array</span>
</span></span></code></pre></div><p>Every recursive function must have one. If we have an empty or single-item array, there&rsquo;s nothing to sort. We simply return the array.</p><h3 id=step-1-choose-a-pivot>Step 1: Choose a pivot</h3><p><code>pivot_idx = random.choice(range(len(array)))</code></p><p>The choice of pivot is the difference between having an <code>O(N log N)</code> vs <code>O(N^2)</code> time complexity.</p><p>How so? Let&rsquo;s take an example.</p><p>The worst-case involves having an already sorted array.</p><p><code>array = [1,2,3,4,5]</code></p><p>The image below shows recursion trees using two different pivot selection strategies:</p><p><strong>Legend</strong></p><ul><li>Blue lines => the greater subarray.</li><li>Orange lines => the smaller subarray.</li><li>Red lines => the pivot.</li></ul><p><img src=https://cdn.hashnode.com/res/hashnode/image/upload/v1630829735302/4wvnJNbu8.png alt="Screenshot 2021-09-05 at 1.45.23 PM.png"></p><ol><li><p>Left shows the case where we always choose the first/last item as the pivot. This leads to higher recursion depth as the subproblem size reduces by 1 at each level. We have roughly <code>O(N)</code> levels / recursive calls. Since joining the sub-arrays with the pivot is <code>O(N)</code>, this leads to <code>O(N^2)</code> time complexity.</p></li><li><p>Right shows the ideal case where we choose the median as the pivot at every level. This leads to balanced sub-problems. The recursion depth is lower, roughly <code>O(log N)</code>. This leads to <code>O(N log N)</code> time complexity.</p></li></ol><p><a href=https://www.cs.cmu.edu/afs/cs/academic/class/15451-s07/www/lecture_notes/lect0123.pdf>Choosing a random pivot leads to an <em>expected</em> runtime of <code>O(N log N)</code> time complexity</a>. We use that in this implementation.</p><p>Wait! There&rsquo;s still one case where <code>quicksort()</code> could be <code>O(N^2)</code>, even after choosing a randomized/median pivot. This is the case when every item in the array is identical. We could add a check to avoid this case as well.</p><p>According to this <a href=https://algs4.cs.princeton.edu/23quicksort/>source</a> ,</p><blockquote><p>The probability that quicksort will use a quadratic number of compares when sorting a large array on your computer is much less than the probability that your computer will be struck by lightning!</p></blockquote><h3 id=step-2-partition>Step 2: Partition</h3><p>We write the high-level function assuming that we have a magic function <code>partition()</code> which returns two arrays.</p><ul><li><code>smaller_subarray</code>: all elements <code>&lt;=</code> the pivot</li><li><code>greater_subarray</code>: all elements <code>></code> the pivot</li></ul><p>The implementation of <code>partition()</code> is quite simple. We compare each item in the array with the pivot. If it&rsquo;s <code>&lt;=</code> pivot, we add it to the smaller sub-array, else we add it to the greater sub-array.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>partition</span><span class=p>(</span><span class=n>array</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>pivot_idx</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Parition array into subarrays smaller and greater than the pivot.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        array (List[int]): input array
</span></span></span><span class=line><span class=cl><span class=s2>        pivot_idx (int): index of the pivot
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        Tuple[List[int], List[int]]: smaller subarray, greater subarray
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>smaller_subarray</span><span class=p>,</span> <span class=n>greater_subarray</span> <span class=o>=</span> <span class=p>[],</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>item</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>array</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># we don&#39;t want to add pivot to any of the sub-arrays</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>idx</span> <span class=o>==</span> <span class=n>pivot_idx</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>item</span> <span class=o>&lt;=</span> <span class=n>array</span><span class=p>[</span><span class=n>pivot_idx</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>smaller_subarray</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>greater_subarray</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>smaller_subarray</span><span class=p>,</span> <span class=n>greater_subarray</span>
</span></span></code></pre></div><h3 id=step-3-merge>Step 3: Merge</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>quicksort</span><span class=p>(</span><span class=n>smaller_subarray</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>+</span> <span class=p>[</span><span class=n>array</span><span class=p>[</span><span class=n>pivot_idx</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=o>+</span> <span class=n>quicksort</span><span class=p>(</span><span class=n>greater_subarray</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div><p>This step is quite exquisite. We recurse on the smaller and greater sub-arrays and place the pivot in between them. The beauty of a recursive implementation is that we could re-use our function with a smaller size of the input and trust that it would work.</p><p>Let&rsquo;s unroll it a bit.</p><ul><li><code>quicksort(smaller_subarray)</code> => returns a sorted version of the <code>smaller_subarray</code></li><li><code>[array[pivot_idx]]</code> => out pivot in a list. It&rsquo;s needed for concatenating it with the other two lists.</li><li><code>quicksort(greater_subarray)</code> => returns a sorted version of the <code>greater_subarray</code></li></ul><p>Now, we join the 3 lists including the pivot, and return the final sorted list.</p><h2 id=complexity>Complexity</h2><h3 id=time>Time</h3><p><strong>Expected</strong> run-time of <code>O(N log N)</code> since it&rsquo;s a randomized implementation.</p><p>We do <code>O(N)</code> work at each <code>quicksort()</code> call. The major components are <code>partition()</code> and merge step - both are <code>O(N)</code>.</p><p>For randomized implementation, we have O(log N) levels/recursive calls.</p><p>So, expected time complexity ~ <code>Number of recursive calls</code> * <code>work done per recursive call</code> ~ <code>O(N) * O(log N)</code> ~ <code>O(N log N)</code></p><h3 id=space>Space</h3><p><code>O(N)</code> since we use extra space for storing the smaller and greater sub-arrays. The recursion stack also uses <code>O(log N)</code> space. Overall, this implementation uses <code>O(N)</code> space.</p><p>The in-place implementation without using auxiliary lists would lead to an <code>O(log N)</code> space complexity.</p><h2 id=the-code>The code</h2><p>The implementation including the <code>partition()</code> and tests are <a href=https://gist.github.com/saikatkumardey/5c0eb3ed8d187046ed7d46ff4dab8fe1>here</a>.</p></div><div class=post__footer><span><a class=tag href=/tags/coding/>coding</a></span></div></div></main></div><footer class="footer footer__base"><ul class=footer__list><li class=footer__item>&copy;
Saikat Kumar Dey
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></body></html>