<!doctype html><html><head><meta charset=utf-8><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Issues with using accuracy as an evaluation metric and what you should use instead"><base href=https://saikatkumardey.com/><title>Accuracy Is a Poor evaluation Metric | Saikat Kumar Dey</title><link rel=canonical href=https://saikatkumardey.com/posts/accuracy-is-a-poor-error-metric/><link href=https://saikatkumardey.com/css/style-v1.css type=text/css rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Alegreya&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Fira+Mono&display=swap" rel=stylesheet><meta name=twitter:card content="summary"><meta name=twitter:title content="Accuracy Is a Poor evaluation Metric"><meta name=twitter:description content="Issues with using accuracy as an evaluation metric and what you should use instead"><script async src="https://www.googletagmanager.com/gtag/js?id=G-X1SHK8DN16"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-X1SHK8DN16",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-X1SHK8DN16","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><div class=container><header><h1><a href=https://saikatkumardey.com/>Saikat Kumar Dey</a></h1><nav><ul><li><a href=https://saikatkumardey.com/posts/ title>Posts</a></li><li><a href=https://saikatkumardey.com/projects/ title>Projects</a></li><li><a href=https://saikatkumardey.com/now/ title>Now</a></li></ul></nav></header><div id=content><main class=essay><h1 id=title>Accuracy Is a Poor evaluation Metric</h1><div class=meta><span class=date>June 7, 2022</span></div><div><div class=toc><nav id=TableOfContents></nav></div><article id=content><p>For classification problems, something like Cross-entropy is a good metric for minimizing your model&rsquo;s loss.
However, we need something easier to convey to the stakeholders.
Accuracy is a very easy way to show our model performances. The caveat? Accuracy would be misleading for imbalanced classes.</p><p>Here&rsquo;s why.</p><p>Let&rsquo;s say that you&rsquo;ve built a model for detecting cancer.
Here&rsquo;s how the confusion matrix would look like for a dataset on cancer cases.</p><table><thead><tr><th></th><th>Predicted Cancer</th><th>Predicted cancer-free</th></tr></thead><tbody><tr><td>Actual cancer cases</td><td>10 (TP)</td><td>5 (FN)</td></tr><tr><td>Actual cancer-free cases</td><td>150 (FP)</td><td>800 (TN)</td></tr></tbody></table><p>The dataset has 950 cancer-free patients and 15 patients with cancer.
The accuracy of the model = fraction of correct predictions = (10 + 800) / (10 + 5 + 150 + 800) = 0.84.</p><p>Well, the cancer cases are quite rare, so it barely has any effect on the accuracy.</p><p>If the model had predicted every case as cancer-free, the confusion matrix would look like the following:</p><table><thead><tr><th></th><th>Predicted Cancer</th><th>Predicted cancer-free</th></tr></thead><tbody><tr><td>Actual cancer cases</td><td>0 (TP)</td><td>15 (FN)</td></tr><tr><td>Actual cancer-free cases</td><td>0 (FP)</td><td>950 (TN)</td></tr></tbody></table><p>Accuracy = 950/(950 + 15) = 0.984%.</p><p>That is not what we want to report to our stakeholders.</p><p>What are our options?</p><p>In such cases with class imbalance, we usually look at <em>precision</em> and <em>recall</em>.</p><p><strong>Precision</strong></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>precision = TP/(TP + FP)
</span></span></code></pre></div><p>Precision is <em>out of all the cancer diagnosis made by the model, how many of them actually have cancer</em>. In the first case, model predicted 165 cases as having cancer but only 15 of them actually had cancer. So, the precision is 15/165 which is quite low!</p><p><strong>Recall</strong></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>recall = TP/(TP+FN)
</span></span></code></pre></div><p>Recall is <em>out of all the actual cancer cases, how many could the model detect?</em>
In the first case, model detected 15 out of 20 cancer cases. So, the recall is 15/20 = 0.75. That&rsquo;s not bad!</p><p>Our objective is to detect as many cancer cases as we can (TP) while minimizing the false diagnosis of cancer (FP). In other words, we want to have high recall with high precision.</p><p>All of these metrics rely on the probability threshold chosen to classify each sample as having cancer or not. If prediction probability > threshold, predict cancer.</p><p>For example, if you choose 0.9 as the threshold, you might only classify cases where the model is highly confident ie, high precision. However, you might miss out on many cases at that threshold ie, low recall. Instead, if you keep 0.1 as the threshold, you might capture all the cancer cases but you&rsquo;d be scaring a lot of other cancer-free patients with misdiagnosis as well.</p><p>By varying the probability threshold, you could check the trade-off between precision & recall, also called the precision-recall curve.</p><p>Sometimes, precision & recall are combined together into one metric, called F1 score.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>F1 = 2 / (1/precision + 1/recall)
</span></span></code></pre></div><p>There&rsquo;s another variant of the precision-recall curve which is agnostic to the probability threshold selected. It&rsquo;s called the ROC curve (Receiver Operating Characteristics). The area under the curve (AUC) is demonstrative of the overall model performance. AUC is useful to know how well the model is in classifying both the classes.</p><p><strong>Conclusion</strong></p><ul><li>Do not use accuracy metric when there&rsquo;s a class imbalance.</li><li>Use F1 or ROC-AUC instead.</li></ul><hr><p><strong>Reference</strong></p><ol><li><p><a href=https://www.oreilly.com/library/view/practical-machine-learning/9781098102357/>Practical Machine Learning for Computer Vision</a></p></li><li><p><a href=https://en.wikipedia.org/wiki/Precision_and_recall>Precision Recall</a></p></li><li><p><a href=https://en.wikipedia.org/wiki/Receiver_operating_characteristic>ROC Curve</a></p></li></ol></article></div><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=Issues%20with%20using%20accuracy%20as%20an%20evaluation%20metric%20and%20what%20you%20should%20use%20instead.&amp;url=https%3a%2f%2fsaikatkumardey.com%2fposts%2faccuracy-is-a-poor-error-metric%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Accuracy%20Is%20a%20Poor%20evaluation%20Metric&amp;body=https%3a%2f%2fsaikatkumardey.com%2fposts%2faccuracy-is-a-poor-error-metric%2f" target=_self rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsaikatkumardey.com%2fposts%2faccuracy-is-a-poor-error-metric%2f&amp;title=Accuracy%20Is%20a%20Poor%20evaluation%20Metric&amp;summary=Issues%20with%20using%20accuracy%20as%20an%20evaluation%20metric%20and%20what%20you%20should%20use%20instead&amp;source=https%3a%2f%2fsaikatkumardey.com%2fposts%2faccuracy-is-a-poor-error-metric%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=Accuracy%20Is%20a%20Poor%20evaluation%20Metric https%3a%2f%2fsaikatkumardey.com%2fposts%2faccuracy-is-a-poor-error-metric%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3.0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7.0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1.0-5.2 4.2-9.4 9.4-9.4 2.5.0 4.9 1 6.7 2.8s2.8 4.2 2.8 6.7c-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2s0-.5.1-.6.3-.3.4-.5c.2-.1.3-.3.4-.5s0-.4.0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg></div></div><a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fsaikatkumardey.com%2fposts%2faccuracy-is-a-poor-error-metric%2f&amp;t=Accuracy%20Is%20a%20Poor%20evaluation%20Metric" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314 17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258s2.552-5.27 3.877-8.052L103.49.0h18.69L77.84 83.308v53.087h-16.9v-54.08z"/></svg></div></div></a></a></main></div><footer><div><p><div class=social-icons><a href=https://www.linkedin.com/in/saikatkumardey/ target=_blank rel="noopener noreferrer me" title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a href=https://github.com/saikatkumardey/ target=_blank rel="noopener noreferrer me" title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/saikatkrdey/ target=_blank rel="noopener noreferrer me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://www.instagram.com/saikatkumardey/ target=_blank rel="noopener noreferrer me" title=Instagram><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"/><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/></svg></a></div>Powered by <a hre=https://gohugo.io/>Hugo</a>, theme <a href=https://github.com/caramelomartins/hugo-theme-candy>Candy</a></p></div></footer></div></body></html>